export PATH=$PATH:/usr/local/go/bin/


cd ../asset-transfer-basic/chaincode-go

GO111MODULE=on go mod vendor

cd ../../sixEC2Demo/


export PATH=${PWD}/../bin:${PWD}:$PATH
export FABRIC_CFG_PATH=$PWD/../config/

export CORE_PEER_TLS_ENABLED=true
export CORE_PEER_LOCALMSPID="Org1MSP"
export CORE_PEER_TLS_ROOTCERT_FILE=${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=${PWD}/organizations/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp
export CORE_PEER_ADDRESS=peer0.org1.example.com:7051
export ORDERER_CA=${PWD}/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem


peer lifecycle chaincode package basic1.tar.gz --lang golang --path ../asset-transfer-basic/chaincode-go --label basic_1

peer lifecycle chaincode install basic1.tar.gz

export version=1
export packageID=basic_1:9820659c595e662a849033ca23b4424e87a126e8f40b5f81ace59820b81fe8e7

peer lifecycle chaincode approveformyorg --orderer localhost:7050 --ordererTLSHostnameOverride orderer.example.com --channelID mychannel --name basic1 -v $version --package-id $packageID --sequence $version --tls --cafile $ORDERER_CA






export PATH=$PATH:/usr/local/go/bin/


cd ../asset-transfer-basic/chaincode-go

GO111MODULE=on go mod vendor

cd ../../sixEC2Demo/


export CORE_PEER_TLS_ENABLED=true
export CORE_PEER_LOCALMSPID="Org2MSP"
export CORE_PEER_TLS_ROOTCERT_FILE=${PWD}/organizations/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt
erOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=${PWD}/organizations/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp
export CORE_PEER_ADDRESS=peer0.org2.example.com:7051
export ORDERER_CA=${PWD}/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem

peer lifecycle chaincode package basic1.tar.gz --lang golang --path ../asset-transfer-basic/chaincode-go --label basic_1


peer lifecycle chaincode install basic1.tar.gz

export version=1
export packageID=basic_1:9820659c595e662a849033ca23b4424e87a126e8f40b5f81ace59820b81fe8e7

peer lifecycle chaincode approveformyorg --orderer orderer.example.com:7050 --ordererTLSHostnameOverride orderer.example.com --channelID mychannel --name basic1 -v $version --package-id $packageID --sequence $version --tls --cafile $ORDERER_CA


export PEER0_ORG1_CA=${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt
export PEER0_ORG2_CA=${PWD}/organizations/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt

peer lifecycle chaincode commit -o orderer.example.com:7050 --ordererTLSHostnameOverride orderer.example.com --peerAddresses peer0.org1.example.com:7051 --tlsRootCertFiles ${PEER0_ORG1_CA} --peerAddresses peer0.org2.example.com:7051 --tlsRootCertFiles ${PEER0_ORG2_CA} --channelID mychannel --name basic1 -v $version  --sequence $version --tls --cafile $ORDERER_CA --waitForEvent




peer chaincode invoke -o orderer.example.com:7050 --tls true --cafile $ORDERER_CA -C mychannel -n basic1 --peerAddresses peer0.org1.example.com:7051 --tlsRootCertFiles ${PEER0_ORG1_CA} --peerAddresses peer0.org2.example.com:7051 --tlsRootCertFiles ${PEER0_ORG2_CA} -c '{"Args":["InitLedger"]}' --waitForEvent


peer chaincode query -C mychannel -n basic1 -c '{"Args":["GetAllAssets"]}'
